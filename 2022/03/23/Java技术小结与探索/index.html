<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CPT+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zerostione.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>
<meta name="description" content="在想要攀登到科学顶峰之前，务必把科学的初步知识研究透彻。还没有充分领会前面的东西时，就决不要动手搞往后的事情。">
<meta property="og:type" content="article">
<meta property="og:title" content="Java技术小结与探索">
<meta property="og:url" content="https://zerostione.github.io/2022/03/23/Java%E6%8A%80%E6%9C%AF%E5%B0%8F%E7%BB%93%E4%B8%8E%E6%8E%A2%E7%B4%A2/index.html">
<meta property="og:site_name" content="Zero">
<meta property="og:description" content="在想要攀登到科学顶峰之前，务必把科学的初步知识研究透彻。还没有充分领会前面的东西时，就决不要动手搞往后的事情。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zerostione.github.io/ImageUp//Image/Blog/Java/p19.jpg">
<meta property="og:image" content="https://zerostione.github.io/ImageUp//Image/Blog/SSM/Spring/p22.png">
<meta property="og:image" content="https://zerostione.github.io/ImageUp//Image/Blog/SSM/Spring/p23.png">
<meta property="og:image" content="https://zerostione.github.io/ImageUp//Image/Blog/JavaTip/p1.png">
<meta property="og:image" content="https://zerostione.github.io/ImageUp//Image/Blog/JavaTip/p2.png">
<meta property="og:image" content="https://zerostione.github.io/ImageUp//Image/Blog/JavaTip/p3.png">
<meta property="og:image" content="https://zerostione.github.io/ImageUp//Image/Blog/JavaTip/p1.jpg">
<meta property="og:image" content="https://zerostione.github.io/ImageUp//Image/Blog/JavaTip/p2.jpg">
<meta property="article:published_time" content="2022-03-23T06:13:55.000Z">
<meta property="article:modified_time" content="2022-04-02T06:44:35.833Z">
<meta property="article:author" content="Zero">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Spring">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zerostione.github.io/ImageUp//Image/Blog/Java/p19.jpg">


<link rel="canonical" href="https://zerostione.github.io/2022/03/23/Java%E6%8A%80%E6%9C%AF%E5%B0%8F%E7%BB%93%E4%B8%8E%E6%8E%A2%E7%B4%A2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://zerostione.github.io/2022/03/23/Java%E6%8A%80%E6%9C%AF%E5%B0%8F%E7%BB%93%E4%B8%8E%E6%8E%A2%E7%B4%A2/","path":"2022/03/23/Java技术小结与探索/","title":"Java技术小结与探索"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Java技术小结与探索 | Zero</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Zero</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">发现未知，探索未知</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring"><span class="nav-number">1.</span> <span class="nav-text">Spring</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Bean%E4%B8%8EComponent"><span class="nav-number">1.1.</span> <span class="nav-text">Bean与Component</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java-JSON"><span class="nav-number">1.2.</span> <span class="nav-text">Java JSON</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Jackson"><span class="nav-number">1.2.1.</span> <span class="nav-text">Jackson</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fastjson"><span class="nav-number">1.2.2.</span> <span class="nav-text">Fastjson</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Gson"><span class="nav-number">1.2.3.</span> <span class="nav-text">Gson</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pojo-Bean"><span class="nav-number">1.3.</span> <span class="nav-text">Pojo Bean</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Zero"
      src="https://zerostione.github.io/ImageUp//Image/Blog/Use/ue.jpg">
  <p class="site-author-name" itemprop="name">Zero</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">25</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zerostione.github.io/2022/03/23/Java%E6%8A%80%E6%9C%AF%E5%B0%8F%E7%BB%93%E4%B8%8E%E6%8E%A2%E7%B4%A2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://zerostione.github.io/ImageUp//Image/Blog/Use/ue.jpg">
      <meta itemprop="name" content="Zero">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zero">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Java技术小结与探索
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-03-23 14:13:55" itemprop="dateCreated datePublished" datetime="2022-03-23T14:13:55+08:00">2022-03-23</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2022-04-02 14:44:35" itemprop="dateModified" datetime="2022-04-02T14:44:35+08:00">2022-04-02</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>  在想要攀登到科学顶峰之前，务必把科学的初步知识研究透彻。还没有充分领会前面的东西时，就决不要动手搞往后的事情。</p>
<img src="https://zerostione.github.io/ImageUp//Image/Blog/Java/p19.jpg" style="zoom: 33%;" />

  

<span id="more"></span>

<h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><img src="https://zerostione.github.io/ImageUp//Image/Blog/SSM/Spring/p22.png" style="zoom: 80%;" />

<img src="https://zerostione.github.io/ImageUp//Image/Blog/SSM/Spring/p23.png" style="zoom: 80%;" />

<h2 id="Bean与Component"><a href="#Bean与Component" class="headerlink" title="Bean与Component"></a>Bean与Component</h2><p><strong>@Component(@Controller @Service @Respository)</strong>:Class</p>
<ul>
<li>表明该类会作为组件类，告知Spring容器为该类创建bean(通过类路径扫描自动装配到Spring容器中)。</li>
<li>通过组件扫描，Spring将扫描整个类路径，并将所有@Component注释类添加到Spring Context。Component会把整个类当成bean注册到Spring容器中。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(String name, Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Dao层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="function">User <span class="title">selectUserByID</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*通常由MyBatis完成*/</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;-&gt;UserDaoImpl:addUser&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteUserById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;-&gt;UserDaoImpl:deleteUser&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">selectUserByID</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;-&gt;UserDaoImpl:selectUserByID&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> User(<span class="string">&quot;tester&quot;</span>,<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Service层</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">deleteUserById</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">    <span class="function">User <span class="title">selectUserByID</span><span class="params">(<span class="keyword">int</span> id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span> <span class="comment">/*去掉Service自动装配UserServiceImpl2*/</span></span><br><span class="line"><span class="meta">@Primary</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl1</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserDao userDao;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> userDao.addUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteUserById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userDao.deleteUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">selectUserByID</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        System.out.print(<span class="string">&quot;===UserServiceImpl1:&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> userDao.selectUserByID(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl2</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserDao userDao;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userDao.addUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">deleteUserById</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userDao.deleteUserById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">selectUserByID</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        System.out.print(<span class="string">&quot;===UserServiceImpl2:&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> userDao.selectUserByID(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApplicationTests</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*Could not autowire. There is more than one bean of &#x27;UserService&#x27; type.Beans:userServiceImpl1 (UserServiceImpl1.java)userServiceImpl2 (UserServiceImpl2.java)*/</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserService userService;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        userService.selectUserByID(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Qualifier(&quot;userServiceImpl1&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl1</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Qualifier(&quot;userServiceImpl2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl2</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="meta">@Qualifier(&quot;userServiceImpl1&quot;)</span></span><br><span class="line">UserService userService;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>@Autowired自动装配:根据UserDao的类型寻找对应的bean，此处即为UserDao注册在Spring容器中的两个对应的实现类UserServiceImpl1和UserServiceImpl2（虽然定义属性是接口类型，但最终装配时是对应的实现类）。当该接口具有多个实现类，需要在@Autowired自动装配时使用@Primary(在实现类上使用，即优先选择)或者@Qualifier进行指定一个实现类进行注入。</p>
</blockquote>
<hr>
<hr>
<p><strong>@Bean</strong>:Method</p>
<ul>
<li>表明该方法将会返回一个对象，该对象会注册为Spring应用上下文的bean。通常该方法定义产生bean实例的逻辑。</li>
<li>更加灵活，可以独立加在方法上(Bean的声明与类定义分离)，按需注册到Spring容器，当需要用到第三方类库里面某个方法，可以用@Bean把这个方法注册到Spring容器。</li>
<li>需要在配置类中使用，即类上需用@Configuration注解。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBean</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String myBeanName;</span><br><span class="line">    <span class="meta">@Value(&quot;1&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer myBeanId;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMyBeanName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> myBeanName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyBeanName</span><span class="params">(String myBeanName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myBeanName = myBeanName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getMyBeanId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> myBeanId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMyBeanId</span><span class="params">(Integer myBeanId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.myBeanId = myBeanId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;MyBean&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;myBeanName=&#x27;&quot;</span> + myBeanName + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, myBeanId=&quot;</span> + myBeanId +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">/*bean名称默认方法名*/</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MyBean <span class="title">myBean</span><span class="params">()</span></span>&#123;</span><br><span class="line">        MyBean myBean = <span class="keyword">new</span> MyBean();</span><br><span class="line">        myBean.setMyBeanName(<span class="string">&quot;MyFirstBean&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> myBean;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyBeanApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    MyBean myBean2;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMyBean</span><span class="params">()</span></span>&#123;</span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> AnnotationConfigApplicationContext(AppConfig.class);</span><br><span class="line">        <span class="comment">/*1.@AutoWired可通过byName byType constructor和autodetect方式进行自动装配，所以修改方法名仍然可以自动装配，此处无法根据错误的方法名获取bean</span></span><br><span class="line"><span class="comment">        2.方法名通常是返回类名首字母小写*/</span></span><br><span class="line">        Object myBean1 = context.getBean(<span class="string">&quot;myBean&quot;</span>);</span><br><span class="line">        System.out.println(myBean1);</span><br><span class="line">        MyBean myFirstBean = (MyBean)myBean1;</span><br><span class="line">        System.out.println(myFirstBean.getMyBeanName());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMyBean2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(myBean2.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>二者都可以通过@Autowired装配</p>
</blockquote>
<hr>
<p><code>@Component</code> and Further Stereotype Annotations</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6827752/whats-the-difference-between-component-repository-service-annotations-in">Difference between @Component, @Repository &amp; @Service annotations in Spring</a></li>
</ul>
<blockquote>
<p>The <code>@Repository</code> annotation is a marker for any class that fulfills the role or stereotype of a repository (also known as Data Access Object or DAO). Among the uses of this marker is the automatic translation of exceptions, as described in <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/current/reference/html/data-access.html#orm-exception-translation">Exception Translation</a>.</p>
<p>Spring provides further stereotype annotations: <code>@Component</code>, <code>@Service</code>, and <code>@Controller</code>. <code>@Component</code> is a generic stereotype for any Spring-managed component. <code>@Repository</code>, <code>@Service</code>, and <code>@Controller</code> are specializations of <code>@Component</code> for more specific use cases (in the persistence, service, and presentation layers, respectively). Therefore, you can annotate your component classes with <code>@Component</code>, but, by annotating them with <code>@Repository</code>, <code>@Service</code>, or <code>@Controller</code> instead, your classes are more properly suited for processing by tools or associating with aspects. For example, these stereotype annotations make ideal targets for pointcuts. <code>@Repository</code>, <code>@Service</code>, and <code>@Controller</code> can also carry additional semantics in future releases of the Spring Framework. Thus, if you are choosing between using <code>@Component</code> or <code>@Service</code> for your service layer, <code>@Service</code> is clearly the better choice. Similarly, as stated earlier, <code>@Repository</code> is already supported as a marker for automatic exception translation in your persistence layer.</p>
</blockquote>
<img src="https://zerostione.github.io/ImageUp//Image/Blog/JavaTip/p1.png" style="zoom:80%;" />

<img src="https://zerostione.github.io/ImageUp//Image/Blog/JavaTip/p2.png" style="zoom: 80%;" />

<table>
<thead>
<tr>
<th align="center">Annotation</th>
<th align="center">Meaning</th>
<th>Scope</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><code>@Component</code></td>
<td align="center">generic stereotype for any Spring-managed component</td>
<td>组件类</td>
</tr>
<tr>
<td align="center"><code>@Repository</code></td>
<td align="center">stereotype for persistence layer</td>
<td>数据库操作、数据传至Service(@Service)层</td>
</tr>
<tr>
<td align="center"><code>@Service</code></td>
<td align="center">stereotype for service layer</td>
<td>业务逻辑、数据处理、调用持久层(Persistence layer/Data Access Layer @Repository)方法等</td>
</tr>
<tr>
<td align="center"><code>@Controller</code></td>
<td align="center">stereotype for presentation layer (spring-mvc)</td>
<td>处理请求（调度、转发、调用Service(@Service层)方法等）</td>
</tr>
</tbody></table>
<hr>
<hr>
<h2 id="Java-JSON"><a href="#Java-JSON" class="headerlink" title="Java JSON"></a>Java JSON</h2><h3 id="Jackson"><a href="#Jackson" class="headerlink" title="Jackson"></a>Jackson</h3><p><a target="_blank" rel="noopener" href="https://github.com/FasterXML/jackson">Jackson</a></p>
<img src="https://zerostione.github.io/ImageUp//Image/Blog/JavaTip/p3.png" style="zoom: 80%;" />

<blockquote>
<p>Jackson是当前用的比较广泛的，用来序列化和反序列化 json 的Java开源框架,是Spring MVC 默认json 解析器。 </p>
<p>特点：</p>
<ul>
<li><p>依赖关系较少 </p>
</li>
<li><p>解析大json文件速度较快</p>
</li>
<li><p>占用内存比较低，性能比较好</p>
</li>
<li><p>易于使用</p>
</li>
</ul>
</blockquote>
<hr>
<h3 id="Fastjson"><a href="#Fastjson" class="headerlink" title="Fastjson"></a>Fastjson</h3><p><a target="_blank" rel="noopener" href="https://github.com/alibaba/fastjson">FastJSON</a></p>
<img src="https://zerostione.github.io/ImageUp//Image/Blog/JavaTip/p1.jpg" style="zoom: 80%;" />

<blockquote>
<p>fastjson是阿里巴巴的开源JSON解析库，它可以解析JSON格式的字符串，支持将Java Bean序列化为JSON字符串，也可以从JSON字符串反序列化到JavaBean。</p>
<p>特点：</p>
<ul>
<li><p>速度快</p>
</li>
<li><p>国内使用广泛</p>
</li>
<li><p>测试完备</p>
</li>
<li><p>使用简单</p>
</li>
</ul>
</blockquote>
<hr>
<h3 id="Gson"><a href="#Gson" class="headerlink" title="Gson"></a>Gson</h3><p><a target="_blank" rel="noopener" href="https://github.com/google/gson">Gson</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/3108f1e44155">Gson使用指南</a></p>
<img src="https://zerostione.github.io/ImageUp//Image/Blog/JavaTip/p2.jpg" style="zoom: 33%;" />

<blockquote>
<p><strong>Gson</strong>（Google Gson）是Google公司发布的一个开放源代码的Java库，主要用途为序列化Java对象为JSON字符串，或反序列化JSON字符串成Java对象。</p>
<p>Gson当初是为因应Google公司内部需求而由Google自行研发而来，但自从在2008年五月公开发布第一版后已被许多公司或用户应用。</p>
</blockquote>
<p>Spring与Gson</p>
<blockquote>
<p>如果使用Gson作为默认库，需要从<code>classpath</code>中删除Jackson</p>
</blockquote>
<ul>
<li>使用Maven</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Exclude the default Jackson dependency --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-json<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.code.gson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>gson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Exclude property</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication(exclude = &#123;JacksonAutoConfiguration.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GsonSpringBootApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(GsonSpringBootApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>使用HttpMessageConverters自定义</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*自定义JSON转换日期格式*/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplicationConfig</span> <span class="keyword">extends</span> <span class="title">WebMvcConfigurerAdapter</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> </span>&#123;</span><br><span class="line">        converters.add(customGsonHttpMessageConverter());</span><br><span class="line">        <span class="keyword">super</span>.configureMessageConverters(converters);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> GsonHttpMessageConverter <span class="title">customGsonHttpMessageConverter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">                .excludeFieldsWithoutExposeAnnotation()</span><br><span class="line">                .setDateFormat(<span class="string">&quot;yyyy&#x27;-&#x27;MM&#x27;-&#x27;dd&#x27;T&#x27;HH&#x27;:&#x27;mm&#x27;:&#x27;ss&#x27;&quot;</span>)</span><br><span class="line">                .create();</span><br><span class="line"></span><br><span class="line">        GsonHttpMessageConverter gsonMessageConverter = <span class="keyword">new</span> GsonHttpMessageConverter();</span><br><span class="line">        gsonMessageConverter.setGson(gson);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> gsonMessageConverter;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>1.<strong>Gson基本用法</strong></p>
<blockquote>
<p>Gson提供<code>fromJson()</code> 和<code>toJson()</code> 两个方法用于反序列化和序列化。</p>
<ul>
<li><code>Gson.toJson(Object)</code></li>
<li><code>Gson.fromJson(String,Class)</code></li>
<li><code>Gson.fromJson(String,Type)</code></li>
</ul>
</blockquote>
<ul>
<li><p>反序列化</p>
<ul>
<li>基本类型</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line"><span class="keyword">int</span> i = gson.fromJson(<span class="string">&quot;100&quot;</span>, <span class="keyword">int</span>.class);                     <span class="comment">/*100*/</span></span><br><span class="line"><span class="keyword">double</span> aDouble = gson.fromJson(<span class="string">&quot;99.99&quot;</span>, <span class="keyword">double</span>.class);       <span class="comment">/*99.99*/</span></span><br><span class="line"><span class="keyword">boolean</span> aBoolean = gson.fromJson(<span class="string">&quot;true&quot;</span>, <span class="keyword">boolean</span>.class);     <span class="comment">/*true*/</span></span><br><span class="line">String aString = gson.fromJson(<span class="string">&quot;String&quot;</span>, String.class);      <span class="comment">/*String*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>简单实体类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Double price;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">Product sugar_box = <span class="keyword">new</span> Product(<span class="string">&quot;20210103&quot;</span>, <span class="string">&quot;Sugar Box&quot;</span>, <span class="number">15.69</span>);</span><br><span class="line">String jsonString = gson.toJson(sugar_box); <span class="comment">/*&#123;&quot;id&quot;:&quot;20210103&quot;,&quot;name&quot;:&quot;Sugar Box&quot;,&quot;price&quot;:15.69&#125;*/</span></span><br></pre></td></tr></table></figure></li>
<li><p>序列化</p>
<ul>
<li>基本类型</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">String jsonNumber = gson.toJson(<span class="number">100</span>);       <span class="comment">/*100*/</span></span><br><span class="line">String jsonBoolean = gson.toJson(<span class="keyword">false</span>);    <span class="comment">/*false*/</span></span><br><span class="line">String jsonString = gson.toJson(<span class="string">&quot;String&quot;</span>);  <span class="comment">/*String*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>简单实体类</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">String jsonString1 = <span class="string">&quot;&#123;\&quot;id\&quot;:\&quot;20210103\&quot;,\&quot;name\&quot;:\&quot;Sugar Box\&quot;,\&quot;price\&quot;:15.69&#125;&quot;</span>;</span><br><span class="line">Product sugar_box = gson.fromJson(jsonString1,Product.class); <span class="comment">/*Product(id=20210103, name=Sugar Box, price=15.69)*/</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<p>2.<code>@SerializedName</code></p>
<blockquote>
<p>@SerializedName：属性重命名，可以将json中的属性名转换为自定义的属性名(原属性名失效)</p>
<ul>
<li><code>value</code>:json属性名</li>
<li><code>alternate</code>：(备选属性名)接收一个String数组alternate数组中出现任意一个属性名都可以转换为自定义的属性，如果出现多个则以最后一个为准</li>
</ul>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SerializedName(&quot;box_price&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Double price;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">String jsonStr1 = <span class="string">&quot;&#123;\&quot;id\&quot;:\&quot;20090804\&quot;,\&quot;name\&quot;:\&quot;Wooden Box\&quot;,\&quot;box_price\&quot;:16.69&#125;&quot;</span>;</span><br><span class="line">String jsonStr2 = <span class="string">&quot;&#123;\&quot;id\&quot;:\&quot;20190412\&quot;,\&quot;name\&quot;:\&quot;Iron Box\&quot;,\&quot;price\&quot;:16.69&#125;&quot;</span>;</span><br><span class="line">Product woodenBox = gson.fromJson(jsonStr1,Product.class);</span><br><span class="line">Product ironBox = gson.fromJson(jsonStr2,Product.class); </span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Product(id=20090804, name=Wooden Box, price=16.69)</span></span><br><span class="line"><span class="comment">Product(id=20190412, name=Iron Box, price=null)</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SerializedName(value = &quot;price&quot;,alternate = &#123;&quot;box_price&quot;,&quot;chest_price&quot;&#125;)</span></span><br><span class="line"><span class="keyword">private</span> Double price;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">String jsonStr1 = <span class="string">&quot;&#123;\&quot;id\&quot;:\&quot;20090804\&quot;,\&quot;name\&quot;:\&quot;Wooden Box\&quot;,\&quot;box_price\&quot;:15.34&#125;&quot;</span>;</span><br><span class="line">String jsonStr2 = <span class="string">&quot;&#123;\&quot;id\&quot;:\&quot;20190412\&quot;,\&quot;name\&quot;:\&quot;Case Box\&quot;,\&quot;chest_price\&quot;:17.56&#125;&quot;</span>;</span><br><span class="line">String jsonStr3 = <span class="string">&quot;&#123;\&quot;id\&quot;:\&quot;20200916\&quot;,\&quot;name\&quot;:\&quot;Iron Box\&quot;,\&quot;price\&quot;:16.69&#125;&quot;</span>;</span><br><span class="line">String jsonStr4 = <span class="string">&quot;&#123;\&quot;id\&quot;:\&quot;20050412\&quot;,\&quot;name\&quot;:\&quot;Box\&quot;,\&quot;price\&quot;:16.6,\&quot;box_price\&quot;:1.69,\&quot;chest_price\&quot;:0.69&#125;&quot;</span>;</span><br><span class="line">Product woodenBox = gson.fromJson(jsonStr1,Product.class);</span><br><span class="line">Product caseBox = gson.fromJson(jsonStr2,Product.class);</span><br><span class="line">Product ironBox = gson.fromJson(jsonStr3,Product.class);</span><br><span class="line">Product box = gson.fromJson(jsonStr4,Product.class);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Product(id=20090804, name=Wooden Box, price=15.34)</span></span><br><span class="line"><span class="comment">Product(id=20190412, name=Case Box, price=17.56)</span></span><br><span class="line"><span class="comment">Product(id=20200916, name=Iron Box, price=16.69)</span></span><br><span class="line"><span class="comment">Product(id=20050412, name=Box, price=0.69)</span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure>

<hr>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">String jsonArray = <span class="string">&quot;[\&quot;Kotlin\&quot;,\&quot;Groovy\&quot;,\&quot;Scala\&quot;]&quot;</span>;</span><br><span class="line">String[] strings = gson.fromJson(jsonArray, String[].class);</span><br><span class="line">List&lt;String&gt; stringList = gson.fromJson(jsonArray, <span class="keyword">new</span> TypeToken&lt;List&lt;String&gt;&gt;()&#123;&#125;.getType());</span><br><span class="line"><span class="keyword">for</span>(String str:strings)&#123;</span><br><span class="line">    System.out.println(str);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(stringList.toString());</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>3.泛型</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">String jsonArray = <span class="string">&quot;[\&quot;Kotlin\&quot;,\&quot;Groovy\&quot;,\&quot;Scala\&quot;]&quot;</span>;</span><br><span class="line">String[] strings = gson.fromJson(jsonArray, String[].class);</span><br><span class="line">List&lt;String&gt; stringList = gson.fromJson(jsonArray, <span class="keyword">new</span> TypeToken&lt;List&lt;String&gt;&gt;()&#123;&#125;.getType());</span><br><span class="line"><span class="keyword">for</span>(String str:strings)&#123;</span><br><span class="line">    System.out.println(str);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(stringList.toString());</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*避免重复定义多个类*/</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Result</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> code;</span><br><span class="line">    <span class="keyword">public</span> String message;</span><br><span class="line">    <span class="keyword">public</span> T data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">Type userType = <span class="keyword">new</span> TypeToken&lt;Result&lt;User&gt;&gt;()&#123;&#125;.getType();</span><br><span class="line">Type userListType = <span class="keyword">new</span> TypeToken&lt;Result&lt;List&lt;User&gt;&gt;&gt;()&#123;&#125;.getType();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1.Gson提供TypeToken实现对泛型的支持</span></span><br><span class="line"><span class="comment">TypeToken的构造方法是protected修饰,即应该写为new TypeToken&lt;List&lt;String&gt;&gt;() &#123;&#125;.getType() 而非 new TypeToken&lt;List&lt;String&gt;&gt;().getType()</span></span><br><span class="line"><span class="comment">2.List&lt;Object&gt;的字节码文件只有List.class（泛型擦除），使用List&lt;String&gt; stringList = gson.fromJson(jsonArray, List.class);可以成功，即数据解析为List&lt;String&gt;不需要TypeToken，但泛型中除了基本类型和String可以成功外，但其他的会转为LinkedTreeMap丢失类型信息，同时这种方法也难以应付多种应用场景，难以减少冗余代码。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">String json = <span class="string">&quot;&#123;\&quot;code\&quot;:\&quot;200\&quot;,\&quot;message\&quot;:\&quot;success\&quot;,\&quot;data\&quot;:&#123;\&quot;name\&quot;:\&quot;Zha\&quot;,\&quot;age\&quot;:12&#125;&#125;&quot;</span>;</span><br><span class="line">String jsonList = <span class="string">&quot;&#123;\&quot;code\&quot;:\&quot;404\&quot;,\&quot;message\&quot;:\&quot;Resource not found\&quot;,\&quot;data\&quot;:[&#123;\&quot;name\&quot;:\&quot;Li\&quot;,\&quot;age\&quot;:19&#125;,&#123;\&quot;name\&quot;:\&quot;Wu\&quot;,\&quot;age\&quot;:25&#125;,&#123;\&quot;name\&quot;:\&quot;Fu\&quot;,\&quot;age\&quot;:35&#125;]&#125;&quot;</span>;</span><br><span class="line">Result&lt;User&gt; userResult = gson.fromJson(json,userType);</span><br><span class="line">Result&lt;List&lt;User&gt;&gt; userListResult = gson.fromJson(jsonList,userListType);</span><br><span class="line">List&lt;User&gt; users = userListResult.data;</span><br><span class="line">System.out.println(userResult);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Result(code=200, message=success, data=User(name=Zha, age=12))</span></span><br><span class="line"><span class="comment">User(name=Li, age=19)</span></span><br><span class="line"><span class="comment">User(name=Wu, age=25)</span></span><br><span class="line"><span class="comment">User(name=Fu, age=35)</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<p><strong>4.流式序列化和流式反序列化</strong></p>
<p>1.流式序列化</p>
<ul>
<li>自动流式反序列化(<code>Gson.fromJson(Reader,Class)</code> <code>Gson.fromJson(Reader,Type)</code>)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line"><span class="keyword">try</span> (Reader reader = <span class="keyword">new</span> FileReader(<span class="string">&quot;C:\\pro\\user.json&quot;</span>)) &#123;</span><br><span class="line">    User user = gson.fromJson(reader, User.class);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>手动流式反序列化</li>
</ul>
<blockquote>
<p>Gson提供了<code>Stream</code>包的<code>JsonReader</code>类来手动实现反序列化</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">String json = <span class="string">&quot;&#123;\&quot;name\&quot;:\&quot;Zoom\&quot;,\&quot;age\&quot;:\&quot;24\&quot;&#125;&quot;</span>;</span><br><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">JsonReader reader = <span class="keyword">new</span> JsonReader(<span class="keyword">new</span> StringReader(json));</span><br><span class="line">reader.beginObject();</span><br><span class="line"><span class="keyword">while</span> (reader.hasNext()) &#123;</span><br><span class="line">    String str = reader.nextName();</span><br><span class="line">    <span class="keyword">switch</span> (str) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;name&quot;</span>:</span><br><span class="line">            user.setName(reader.nextString());</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;age&quot;</span>:</span><br><span class="line">            user.setAge(reader.nextInt());</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">reader.endObject();</span><br><span class="line"><span class="comment">/*User(name=Zoom, age=24)*/</span></span><br></pre></td></tr></table></figure>

<p>2.流式序列化</p>
<ul>
<li>自动流式序列化<ul>
<li><code>toJson(Object src, Appendable writer) </code></li>
<li><code>toJson(Object src, Type typeOfSrc, Appendable writer) </code></li>
<li><code>toJson(JsonElement jsonElement, Appendable writer)</code></li>
</ul>
</li>
</ul>
<blockquote>
<p><code>Appendable</code>接口:<code>PrintStream</code>(System.out) <code>StringBuilder</code> <code>StringBuffer</code>和 <code>*Writer</code></p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">User user = <span class="keyword">new</span> User(<span class="string">&quot;Pot&quot;</span>,<span class="number">78</span>);</span><br><span class="line">gson.toJson(user,System.out);</span><br><span class="line"><span class="comment">/*&#123;&quot;name&quot;:&quot;Pot&quot;,&quot;age&quot;:78&#125;*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">StringBuilder sb = new StringBuilder();</span></span><br><span class="line"><span class="comment">gson.toJson(user,sb);</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>手动流式序列化</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">JsonWriter writer = <span class="keyword">new</span> JsonWriter(<span class="keyword">new</span> OutputStreamWriter(System.out));</span><br><span class="line">writer.beginObject()</span><br><span class="line">        .name(<span class="string">&quot;name&quot;</span>).value(<span class="string">&quot;Nike&quot;</span>)</span><br><span class="line">        .name(<span class="string">&quot;age&quot;</span>).value(<span class="number">11</span>)</span><br><span class="line">        .name(<span class="string">&quot;email&quot;</span>).nullValue()</span><br><span class="line">        .endObject();</span><br><span class="line">writer.flush();</span><br><span class="line"><span class="comment">/*&#123;&quot;name&quot;:&quot;Nike&quot;,&quot;age&quot;:11,&quot;email&quot;:null&#125;*/</span></span><br><span class="line"></span><br><span class="line">writer.beginArray()</span><br><span class="line">    .value(<span class="string">&quot;Nike&quot;</span>)</span><br><span class="line">    .value(<span class="number">11</span>)</span><br><span class="line">    .nullValue()</span><br><span class="line">    .endArray();</span><br><span class="line">writer.flush();</span><br><span class="line"><span class="comment">/*[&quot;Nike&quot;,11,null]*/</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p><code>beginObject</code>/<code>endObject</code>和<code>beginArray</code>/<code>endArray</code>，两者可相互嵌套。</p>
</li>
<li><p><code>beginArray</code>后不可以调用<code>name</code>方法，<code>beginObject</code>后在调用<code>value</code>之前必须要调用<code>name</code>方法。</p>
</li>
</ul>
</blockquote>
<hr>
<p>5.<strong>GsonBuilder</strong>:构建Gson实例的类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">               .create(); </span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">System.out.println(gson.toJson(<span class="keyword">new</span> User(<span class="string">&quot;Korie&quot;</span>,<span class="number">67</span>))); <span class="comment">/*&#123;&quot;name&quot;:&quot;Korie&quot;,&quot;age&quot;:67&#125;*/</span></span><br><span class="line"><span class="comment">/*Gson默认不会导出值为null的键值对*/</span></span><br><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder().serializeNulls().create();</span><br><span class="line">System.out.println(gson.toJson(<span class="keyword">new</span> User(<span class="string">&quot;Korie&quot;</span>,<span class="number">67</span>))); <span class="comment">/*&#123;&quot;name&quot;:&quot;Korie&quot;,&quot;age&quot;:67,&quot;email&quot;:null&#125;*/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    <span class="comment">/*序列化null*/</span></span><br><span class="line">    .serializeNulls()</span><br><span class="line">    <span class="comment">/*设置日期时间格式*/</span></span><br><span class="line">    .setDateFormat(<span class="string">&quot;yyyy-MM-dd&quot;</span>)</span><br><span class="line">    <span class="comment">/*禁止序列化内部类 Inner Class*/</span></span><br><span class="line">    .disableInnerClassSerialization()</span><br><span class="line">    <span class="comment">/*生成不可执行Json*/</span></span><br><span class="line">    .generateNonExecutableJson()</span><br><span class="line">    <span class="comment">/*禁止转义html标签*/</span></span><br><span class="line">    .disableHtmlEscaping()</span><br><span class="line">    <span class="comment">/*格式化输出*/</span></span><br><span class="line">    .setPrettyPrinting()</span><br><span class="line">    .create();</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>5.字段过滤</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> Boolean isDeveloper;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1.<code>@Expose</code></p>
<blockquote>
<p><code>@Expose</code>注解提供了两个属性:</p>
<ul>
<li>deserialize:默认为true(反序列化生效)</li>
<li>serialize:默认为true(序列化生效)</li>
</ul>
<p>需要和<code>GsonBuilder</code>使用，需要导出的字段上加上@Expose注解，不导出的字段不加。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="meta">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="meta">@Expose</span></span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="meta">@Expose(deserialize = true,serialize = false)</span></span><br><span class="line">    <span class="keyword">private</span> Boolean isDeveloper;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User(<span class="string">&quot;RIOT&quot;</span>,<span class="number">22</span>,<span class="string">&quot;TestLib@gmail.com&quot;</span>,<span class="keyword">true</span>);</span><br><span class="line">String ustr = <span class="string">&quot;&#123;\&quot;name\&quot;:\&quot;Rich\&quot;,\&quot;age\&quot;:26,\&quot;email\&quot;:\&quot;TestLib2@gmail.com\&quot;,\&quot;isDeveloper\&quot;:\&quot;false\&quot;&#125;&quot;</span>;</span><br><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .excludeFieldsWithoutExposeAnnotation()</span><br><span class="line">    .create();</span><br><span class="line">System.out.println(gson.toJson(user));</span><br><span class="line">System.out.println(gson.fromJson(ustr,User.class));</span><br></pre></td></tr></table></figure>

<hr>
<p>2.<code>@Since</code>和<code>@Until</code></p>
<blockquote>
<p>对基于版本的字段导出提供<code>@Since</code>和<code>@Until</code>注解,和GsonBuilder.setVersion(Double)配合使用。<code>当前版本(GsonBuilder设置版本) 大于等于Since的值时该字段导出，小于Until的值时该字段导出。</code>当一个字段被<code>@Since</code> 和<code>@Until</code>同时注解时，需同时满足条件。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SinceUntilSample</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Since(4)</span></span><br><span class="line">    <span class="keyword">private</span> String since;</span><br><span class="line">    <span class="meta">@Until(5)</span></span><br><span class="line">    <span class="keyword">private</span> String until;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SinceUntilSample sinceUntilSample = <span class="keyword">new</span> SinceUntilSample(<span class="string">&quot;since&quot;</span>,<span class="string">&quot;until&quot;</span>);</span><br><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .setVersion(<span class="number">3.9</span>)</span><br><span class="line">    .create();</span><br><span class="line">System.out.println(gson.toJson(sinceUntilSample));</span><br></pre></td></tr></table></figure>

<hr>
<p>3.<strong>访问修饰符</strong></p>
<blockquote>
<p>GsonBuilder 提供 <code>excludeFieldsWithModifiers</code>方法，可自定义可忽略类型，参数为<code>java.lang.reflect.Modifier</code>类属性</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ModifierSample</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> String finalField = <span class="string">&quot;final&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> String staticField = <span class="string">&quot;static&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> String publicField = <span class="string">&quot;public&quot;</span>;</span><br><span class="line">    <span class="keyword">protected</span> String protectedField = <span class="string">&quot;protected&quot;</span>;</span><br><span class="line">    String defaultField = <span class="string">&quot;default&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> String privateField = <span class="string">&quot;private&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ModifierSample modifierSample = <span class="keyword">new</span> ModifierSample();</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">PUBLIC PRIVATE PROTECTED STATIC FINAL SYNCHRONIZED  VOLATILE</span></span><br><span class="line"><span class="comment">TRANSIENT NATIVE INTERFACE  ABSTRACT  STRICT</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .excludeFieldsWithModifiers(Modifier.FINAL, Modifier.STATIC,Modifier.PUBLIC, Modifier.PROTECTED,Modifier.PRIVATE)</span><br><span class="line">    .create();</span><br><span class="line">System.out.println(gson.toJson(modifierSample)); <span class="comment">/*&#123;&quot;defaultField&quot;:&quot;default&quot;&#125;*/</span></span><br></pre></td></tr></table></figure>

<p>4.自定义过滤规则</p>
<blockquote>
<p><code>GsonBuilderde</code>的<code>addSerializationExclusionStrategy</code>和<code>addDeserializationExclusionStrategy</code> 分别用于序列化和反序化(Gson提供的ExclusionStrategy接口)。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ModifierSample modifierSample = <span class="keyword">new</span> ModifierSample();</span><br><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .addSerializationExclusionStrategy(<span class="keyword">new</span> ExclusionStrategy() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldSkipField</span><span class="params">(FieldAttributes f)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;publicField&quot;</span>.equals(f.getName())) <span class="keyword">return</span> <span class="keyword">true</span>; <span class="comment">/*字段名排除 return true排除*/</span></span><br><span class="line">            Expose expose = f.getAnnotation(Expose.class);</span><br><span class="line">            <span class="keyword">if</span> (expose != <span class="keyword">null</span> &amp;&amp; expose.deserialize() == <span class="keyword">false</span>) <span class="keyword">return</span> <span class="keyword">true</span>; <span class="comment">/*注解排除*/</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">shouldSkipClass</span><span class="params">(Class&lt;?&gt; clazz)</span> </span>&#123;</span><br><span class="line">            <span class="comment">/*直接排除类 ，return true排除*/</span></span><br><span class="line">            <span class="keyword">return</span> (clazz == <span class="keyword">int</span>.class || clazz == Integer.class);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .create();</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>6.字段映射规则</strong></p>
<ul>
<li>默认实现</li>
</ul>
<blockquote>
<p>1.GsonBuilder</p>
<ul>
<li>FieldNamingStrategy</li>
<li>setFieldNamingPolicy</li>
<li>setFieldNamingStrategy</li>
</ul>
<p>2.@SerializedName 注解拥有最高优先级，有 <code>@SerializedName</code> 注解字段上 <code>FieldNamingStrategy</code> 无法生效。</p>
<p>2.<code>GsonBuilder.setFieldNamingPolicy</code>方法与枚举类<code>FieldNamingPolicy</code>配合使用。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">FieldNamingPolicy</th>
<th align="center">结果</th>
</tr>
</thead>
<tbody><tr>
<td align="center">IDENTITY</td>
<td align="center">原格式</td>
</tr>
<tr>
<td align="center">UPPER_CAMEL_CASE</td>
<td align="center">首个字母大写</td>
</tr>
<tr>
<td align="center">UPPER_CAMEL_CASE_WITH_SPACES</td>
<td align="center">空格隔开</td>
</tr>
<tr>
<td align="center">LOWER_CASE_WITH_UNDERSCORES</td>
<td align="center">下划线隔开</td>
</tr>
<tr>
<td align="center">LOWER_CASE_WITH_DASHES</td>
<td align="center">中间线隔开</td>
</tr>
<tr>
<td align="center">LOWER_CASE_WITH_DOTS</td>
<td align="center">点号隔开</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String emailAddress;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User(<span class="string">&quot;VK&quot;</span>,<span class="number">23</span>,<span class="string">&quot;Test@gmail.com&quot;</span>);</span><br><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .setFieldNamingPolicy(FieldNamingPolicy.LOWER_CASE_WITH_DOTS)</span><br><span class="line">    .create();</span><br><span class="line">System.out.println(gson.toJson(user));</span><br><span class="line"><span class="comment">/*&#123;&quot;name&quot;:&quot;VK&quot;,&quot;age&quot;:23,&quot;email.address&quot;:&quot;Test@gmail.com&quot;&#125;*/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>自定义实现</li>
</ul>
<blockquote>
<p>GsonBuilder.setFieldNamingStrategy 方法需要与Gson提供的FieldNamingStrategy接口配合使用，用于将POJO字段与JSON字段对应,FieldNamingPolicy也可以使用setFieldNamingStrategy方法。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User(<span class="string">&quot;VK&quot;</span>,<span class="number">23</span>,<span class="string">&quot;Test@gmail.com&quot;</span>);</span><br><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .setFieldNamingStrategy(<span class="keyword">new</span> FieldNamingStrategy() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">translateName</span><span class="params">(Field field)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;emailAddress&quot;</span>.equals(field.getName())) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;email&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> field.getName();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .create();</span><br><span class="line">System.out.println(gson.toJson(user));</span><br><span class="line"><span class="comment">/*&#123;&quot;name&quot;:&quot;VK&quot;,&quot;age&quot;:23,&quot;email&quot;:&quot;Test@gmail.com&quot;&#125;*/</span></span><br></pre></td></tr></table></figure>

<hr>
<p><strong>7.TypeAdapter</strong></p>
<blockquote>
<p>1.TypeAdapter是Gson自2.0开始提供的一个抽象类，用于接管某种类型的序列化和反序列化过程，包含两个注要方法<code>write(JsonWriter,T)</code>和<code>read(JsonReader)</code>其它方法都是final方法并最终调用这两个抽象方法。</p>
<p>2.TypeAdapter 以及 JsonSerializer 和 JsonDeserializer 都需要与<code>GsonBuilder.registerTypeAdapter</code>或<code>GsonBuilder.registerTypeHierarchyAdapter</code>配合使用。</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">jsonWrite方法</th>
<th align="center">jsonWriter写入字符</th>
</tr>
</thead>
<tbody><tr>
<td align="center">beginArray</td>
<td align="center">[</td>
</tr>
<tr>
<td align="center">endArray</td>
<td align="center">]</td>
</tr>
<tr>
<td align="center">beginObject</td>
<td align="center">{</td>
</tr>
<tr>
<td align="center">endObject</td>
<td align="center">}</td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeAdapter</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TypeAdapter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(JsonWriter var1, T var2)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">toJson</span><span class="params">(Writer out, T value)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        JsonWriter writer = <span class="keyword">new</span> JsonWriter(out);</span><br><span class="line">        <span class="keyword">this</span>.write(writer, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> TypeAdapter&lt;T&gt; <span class="title">nullSafe</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TypeAdapter&lt;T&gt;() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(JsonWriter out, T value)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (value == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    out.nullValue();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    TypeAdapter.<span class="keyword">this</span>.write(out, value);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> T <span class="title">read</span><span class="params">(JsonReader reader)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (reader.peek() == JsonToken.NULL) &#123;</span><br><span class="line">                    reader.nextNull();</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> TypeAdapter.<span class="keyword">this</span>.read(reader);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toJson</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        StringWriter stringWriter = <span class="keyword">new</span> StringWriter();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.toJson(stringWriter, value);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException var4) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError(var4);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> stringWriter.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> JsonElement <span class="title">toJsonTree</span><span class="params">(T value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            JsonTreeWriter jsonWriter = <span class="keyword">new</span> JsonTreeWriter();</span><br><span class="line">            <span class="keyword">this</span>.write(jsonWriter, value);</span><br><span class="line">            <span class="keyword">return</span> jsonWriter.get();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> JsonIOException(var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> T <span class="title">read</span><span class="params">(JsonReader var1)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> T <span class="title">fromJson</span><span class="params">(Reader in)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        JsonReader reader = <span class="keyword">new</span> JsonReader(in);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.read(reader);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> T <span class="title">fromJson</span><span class="params">(String json)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.fromJson((Reader)(<span class="keyword">new</span> StringReader(json)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> T <span class="title">fromJsonTree</span><span class="params">(JsonElement jsonTree)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            JsonReader jsonReader = <span class="keyword">new</span> JsonTreeReader(jsonTree);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.read(jsonReader);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> JsonIOException(var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserTypeAdapter</span> <span class="keyword">extends</span> <span class="title">TypeAdapter</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(JsonWriter jsonWriter, User user)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        jsonWriter.beginObject();</span><br><span class="line">        jsonWriter.name(<span class="string">&quot;name&quot;</span>).value(user.getName());</span><br><span class="line">        jsonWriter.name(<span class="string">&quot;age&quot;</span>).value(user.getAge());</span><br><span class="line">        jsonWriter.name(<span class="string">&quot;emailAddress&quot;</span>).value(user.getEmail());</span><br><span class="line">        jsonWriter.endObject();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">read</span><span class="params">(JsonReader jsonReader)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        jsonReader.beginObject();</span><br><span class="line">        <span class="keyword">while</span> (jsonReader.hasNext()) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (jsonReader.nextName()) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;name&quot;</span>:</span><br><span class="line">                    user.setName(jsonReader.nextString());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;age&quot;</span>:</span><br><span class="line">                    user.setAge(jsonReader.nextInt());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;emailAddress&quot;</span>:</span><br><span class="line">                    user.setEmail(jsonReader.nextString());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        jsonReader.endObject();</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">User user = <span class="keyword">new</span> User(<span class="string">&quot;Gori&quot;</span>, <span class="number">72</span>,<span class="string">&quot;Gori101@gamil.com&quot;</span>);</span><br><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    <span class="comment">/*User注册TypeAdapter*/</span></span><br><span class="line">    .registerTypeAdapter(User.class, <span class="keyword">new</span> UserTypeAdapter())</span><br><span class="line">    .create();</span><br><span class="line">System.out.println(gson.toJson(user));</span><br><span class="line">String str = <span class="string">&quot;&#123;\&quot;name\&quot;:\&quot;vita\&quot;,\&quot;age\&quot;:43,\&quot;emailAddress\&quot;:\&quot;VitaOne@gamil.com\&quot;&#125;&quot;</span>;</span><br><span class="line">System.out.println(gson.fromJson(str,User.class));</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>8.JsonSerializer与JsonDeserializer</strong></p>
<blockquote>
<p>Gson 使用 JsonSerializer 接管序列化过程，JsonDeserializer 接管反序列化过程。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .registerTypeAdapter(Integer.class, <span class="keyword">new</span> JsonDeserializer&lt;Integer&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Integer <span class="title">deserialize</span><span class="params">(JsonElement jsonElement, Type type, JsonDeserializationContext jsonDeserializationContext)</span> <span class="keyword">throws</span> JsonParseException </span>&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> value = jsonElement.getAsInt();</span><br><span class="line">                <span class="keyword">if</span> (value&gt;=<span class="number">24</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> value%<span class="number">24</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> value;</span><br><span class="line">                <span class="comment">/*异常数字转换为-1*/</span></span><br><span class="line">            &#125;<span class="keyword">catch</span> (NumberFormatException e) &#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .create();</span><br><span class="line">System.out.println(gson.fromJson(<span class="string">&quot;10&quot;</span>,Integer.class));   <span class="comment">/*10*/</span></span><br><span class="line">System.out.println(gson.fromJson(<span class="string">&quot;1023&quot;</span>,Integer.class)); <span class="comment">/*15*/</span></span><br><span class="line">System.out.println(gson.fromJson(<span class="string">&quot;err&quot;</span>,Integer.class));  <span class="comment">/*-1*/</span></span><br><span class="line">System.out.println(gson.fromJson(<span class="string">&quot;\&quot;\&quot;&quot;</span>,Integer.class)); <span class="comment">/*-1*/</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*数字序列化*/</span></span><br><span class="line">JsonSerializer&lt;Number&gt; numberJsonSerializer = <span class="keyword">new</span> JsonSerializer&lt;Number&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JsonElement <span class="title">serialize</span><span class="params">(Number src, Type typeOfSrc, JsonSerializationContext context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JsonPrimitive(String.valueOf(src));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*字符串序列化*/</span></span><br><span class="line">JsonSerializer&lt;String&gt; stringJsonSerializer = <span class="keyword">new</span> JsonSerializer&lt;String&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> JsonElement <span class="title">serialize</span><span class="params">(String arg0, Type arg1, JsonSerializationContext arg2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JsonPrimitive(arg0 + <span class="string">&quot;_ADD&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Gson strGson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .registerTypeAdapter(String.class, stringJsonSerializer)</span><br><span class="line">    .create();</span><br><span class="line">System.out.println(strGson.toJson(<span class="string">&quot;JSON&quot;</span>));</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">        1.registerTypeAdapter必须使用包装类型</span></span><br><span class="line"><span class="comment">        2.不能使用父类代替其子类型，即不能直接使用Number.class</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">Gson numberGson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line"></span><br><span class="line">    .registerTypeAdapter(Integer.class, numberJsonSerializer)</span><br><span class="line">    .registerTypeAdapter(Long.class, numberJsonSerializer)</span><br><span class="line">    .registerTypeAdapter(Float.class, numberJsonSerializer)</span><br><span class="line">    .registerTypeAdapter(Double.class, numberJsonSerializer)</span><br><span class="line">    .create();</span><br><span class="line">System.out.println(numberGson.toJson(<span class="number">100.0f</span>));</span><br><span class="line"><span class="comment">/*registerTypeHierarchyAdapter可直接使用Number.class*/</span></span><br><span class="line">Gson numberGsonWitheHierarchy = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .registerTypeHierarchyAdapter(Number.class, numberJsonSerializer)</span><br><span class="line">    .create();</span><br><span class="line">System.out.println(numberGsonWitheHierarchy.toJson(<span class="number">100.01</span>));</span><br><span class="line"><span class="comment">/*&quot;JSON_ADD&quot;*/</span></span><br><span class="line"><span class="comment">/*&quot;100.0&quot;*/</span></span><br><span class="line"><span class="comment">/*100.01&quot;*/</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>1.registerTypeAdapter支持泛型，registerTypeHierarchyAdapter支持继承。</p>
<p>2.如果一个被序列化的对象本身带有泛型且注册相应的TypeAdapter，那么必须调用<code>Gson.toJson(Object,Type)</code>，明确告诉Gson对象类型。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Type type= <span class="keyword">new</span> TypeToken&lt;List&lt;User&gt;&gt;()&#123;&#125;.getType();</span><br><span class="line">TypeAdapter typeAdapter = <span class="keyword">new</span> TypeAdapter&lt;List&lt;User&gt;&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(JsonWriter jsonWriter, List&lt;User&gt; users)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        jsonWriter.beginArray();</span><br><span class="line">        <span class="keyword">for</span>(User user:users)&#123;</span><br><span class="line">            jsonWriter.beginObject();</span><br><span class="line">            jsonWriter.name(<span class="string">&quot;name&quot;</span>).value(user.getName());</span><br><span class="line">            jsonWriter.name(<span class="string">&quot;age&quot;</span>).value(user.getAge());</span><br><span class="line">            jsonWriter.name(<span class="string">&quot;emailAddress&quot;</span>).value(user.getEmail());</span><br><span class="line">            jsonWriter.endObject();</span><br><span class="line">        &#125;</span><br><span class="line">        jsonWriter.endArray();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">read</span><span class="params">(JsonReader jsonReader)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .registerTypeAdapter(type, typeAdapter)</span><br><span class="line">    .create();</span><br><span class="line">List&lt;User&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">list.add(<span class="keyword">new</span> User(<span class="string">&quot;T1&quot;</span>,<span class="number">11</span>,<span class="string">&quot;t1User@qq.com&quot;</span>));</span><br><span class="line">list.add(<span class="keyword">new</span> User(<span class="string">&quot;T2&quot;</span>,<span class="number">22</span>,<span class="string">&quot;t2User@qq.com&quot;</span>));</span><br><span class="line">String result = gson.toJson(list, type);</span><br><span class="line">System.out.println(result);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">[&#123;&quot;name&quot;:&quot;T1&quot;,&quot;age&quot;:11,&quot;emailAddress&quot;:&quot;t1User@qq.com&quot;&#125;,&#123;&quot;name&quot;:&quot;T2&quot;,&quot;age&quot;:22,&quot;emailAddress&quot;:&quot;t2User@qq.com&quot;&#125;]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<hr>
<p><strong>9.TypeAdapterFactory</strong></p>
<blockquote>
<p>可用于创建TypeAdapter的工厂类，通过对比Type，确定有无对应的TypeAdapter，没有返回null。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> GsonBuilder()</span><br><span class="line">    .registerTypeAdapterFactory(<span class="keyword">new</span> TypeAdapterFactory() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> &lt;T&gt; <span class="function">TypeAdapter&lt;T&gt; <span class="title">create</span><span class="params">(Gson gson, TypeToken&lt;T&gt; typeToken)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(typeToken.getType().equals(type))&#123;</span><br><span class="line">                <span class="keyword">return</span> typeAdapter;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .create();</span><br></pre></td></tr></table></figure>

<ul>
<li>CollectionTypeAdapterFactory中的create方法:</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">TypeAdapter&lt;T&gt; <span class="title">create</span><span class="params">(Gson gson, TypeToken&lt;T&gt; typeToken)</span> </span>&#123;</span><br><span class="line">    Type type = typeToken.getType();</span><br><span class="line">    Class&lt;? <span class="keyword">super</span> T&gt; rawType = typeToken.getRawType();</span><br><span class="line">    <span class="keyword">if</span> (!Collection.class.isAssignableFrom(rawType)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Type elementType = Types.getCollectionElementType(type, rawType);</span><br><span class="line">        TypeAdapter&lt;?&gt; elementTypeAdapter = gson.getAdapter(TypeToken.get(elementType));</span><br><span class="line">        ObjectConstructor&lt;T&gt; constructor = <span class="keyword">this</span>.constructorConstructor.get(typeToken);</span><br><span class="line">        TypeAdapter&lt;T&gt; result = <span class="keyword">new</span> CollectionTypeAdapterFactory.Adapter(gson, elementType, elementTypeAdapter, constructor);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>10.JsonAdapter</strong></p>
<blockquote>
<p>1.JsonAdapter注解位于POJO类上，接收一个参数且必须是</p>
<ul>
<li><p>TypeAdpater</p>
</li>
<li><p>TypeAdapterFactory</p>
</li>
<li><p>JsonSerializer</p>
</li>
<li><p>JsonDeserializer</p>
</li>
</ul>
<p>且JsonAdapter无需使用GsonBuilder进行注册。</p>
<p>2.JsonAdapter的优先级比<code>GsonBuilder.registerTypeAdapter</code>的优先级更高。</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserTypeAdapter</span> <span class="keyword">extends</span> <span class="title">TypeAdapter</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(JsonWriter jsonWriter, User user)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        jsonWriter.beginObject();</span><br><span class="line">        jsonWriter.name(<span class="string">&quot;name&quot;</span>).value(user.getName());</span><br><span class="line">        jsonWriter.name(<span class="string">&quot;age&quot;</span>).value(user.getAge());</span><br><span class="line">        jsonWriter.name(<span class="string">&quot;email_Address&quot;</span>).value(user.getEmail());</span><br><span class="line">        jsonWriter.endObject();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">read</span><span class="params">(JsonReader jsonReader)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User();</span><br><span class="line">        jsonReader.beginObject();</span><br><span class="line">        <span class="keyword">while</span> (jsonReader.hasNext()) &#123;</span><br><span class="line">            <span class="keyword">switch</span> (jsonReader.nextName()) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;name&quot;</span>:</span><br><span class="line">                    user.setName(jsonReader.nextString());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;age&quot;</span>:</span><br><span class="line">                    user.setAge(jsonReader.nextInt());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;emailAddress&quot;</span>:</span><br><span class="line">                    user.setEmail(jsonReader.nextString());</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        jsonReader.endObject();</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">User user = <span class="keyword">new</span> User(<span class="string">&quot;SOM&quot;</span>, <span class="number">74</span>, <span class="string">&quot;SONM@qq.com&quot;</span>);</span><br><span class="line">System.out.println(gson.toJson(user));</span><br><span class="line"><span class="comment">/*&#123;&quot;name&quot;:&quot;SOM&quot;,&quot;age&quot;:74,&quot;email_Address&quot;:&quot;SONM@qq.com&quot;&#125;*/</span></span><br></pre></td></tr></table></figure>

<hr>
<hr>
<h2 id="Pojo-Bean"><a href="#Pojo-Bean" class="headerlink" title="Pojo Bean"></a>Pojo Bean</h2><p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/12517905/what-is-java-pojo-class-java-bean-normal-class">What is java pojo class, java bean, normal class?</a></p>
<blockquote>
<p>1.<code>Java Beans</code>:</p>
<ul>
<li>All properties private (use getters/setters)</li>
<li>A public no-argument constructor</li>
<li>Implements Serializable.</li>
</ul>
<p>2.<code>Pojo</code>: Plain Old Java Object is a Java object not bound by any restriction other than those forced by the Java Language Specification. I.e., a POJO should not have to</p>
<ul>
<li>Extend prespecified classes</li>
<li>Implement prespecified interface</li>
<li>Contain prespecified annotations</li>
</ul>
</blockquote>
<blockquote>
<p>POJO通常是不需要是任何类的子类和实现特定的接口以及遵循特定的模式。</p>
</blockquote>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Java/" rel="tag"># Java</a>
              <a href="/tags/Spring/" rel="tag"># Spring</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/03/12/AliYun%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/" rel="prev" title="AliYun使用笔记">
                  <i class="fa fa-chevron-left"></i> AliYun使用笔记
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/04/04/Nginx%E5%AD%A6%E4%B9%A0/" rel="next" title="Nginx学习">
                  Nginx学习 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zero</span>
</div>
 <!-- <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>
  -->

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
